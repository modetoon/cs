/*bayer share price ticker*/

/* jQuery JSONP Core Plugin 2.4.0 (2012-08-21) - https://github.com/jaubourg/jquery-jsonp
 * Copyright (c) 2012 Julian Aubourg - http://www.opensource.org/licenses/mit-license.php */
(function(f){function d(){}function v(F){c=[F]}function o(H,F,G){return H&&H.apply(F.context||F,G)}function n(F){return/\?/.test(F)?"&":"?"}var p="async",t="charset",r="",D="error",u="insertBefore",s="_jqjsp",A="on",g=A+"click",k=A+D,q=A+"load",y=A+"readystatechange",b="readyState",C="removeChild",j="<script>",z="success",B="timeout",e=window,a=f.Deferred,h=f("head")[0]||document.documentElement,x={},m=0,c,l={callback:s,url:location.href},w=e.opera,i=!!f("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;function E(K){K=f.extend({},l,K);var I=K.success,P=K.error,H=K.complete,Y=K.dataFilter,aa=K.callbackParameter,Q=K.callback,Z=K.cache,G=K.pageCache,J=K.charset,L=K.url,ac=K.data,S=K.timeout,O,W=0,U=d,R,N,F,ab,M,V;a&&a(function(ad){ad.done(I).fail(P);I=ad.resolve;P=ad.reject}).promise(K);K.abort=function(){!(W++)&&U()};if(o(K.beforeSend,K,[K])===!1||W){return K}L=L||r;ac=ac?((typeof ac)=="string"?ac:f.param(ac,K.traditional)):r;L+=ac?(n(L)+ac):r;aa&&(L+=n(L)+encodeURIComponent(aa)+"=?");!Z&&!G&&(L+=n(L)+"_"+(new Date()).getTime()+"=");L=L.replace(/=\?(&|$)/,"="+Q+"$1");function X(ad){if(!(W++)){U();G&&(x[L]={s:[ad]});Y&&(ad=Y.apply(K,[ad]));o(I,K,[ad,z,K]);o(H,K,[K,z])}}function T(ad){if(!(W++)){U();G&&ad!=B&&(x[L]=ad);o(P,K,[K,ad]);o(H,K,[K,ad])}}if(G&&(O=x[L])){O.s?X(O.s[0]):T(O)}else{e[Q]=v;ab=f(j)[0];ab.id=s+m++;if(J){ab[t]=J}w&&w.version()<11.6?((M=f(j)[0]).text="document.getElementById('"+ab.id+"')."+k+"()"):(ab[p]=p);if(i){ab.htmlFor=ab.id;ab.event=g}ab[q]=ab[k]=ab[y]=function(ad){if(!ab[b]||!/i/.test(ab[b])){try{ab[g]&&ab[g]()}catch(ae){}ad=c;c=0;ad?X(ad[0]):T(D)}};ab.src=L;U=function(ad){V&&clearTimeout(V);ab[y]=ab[q]=ab[k]=null;h[C](ab);M&&h[C](M)};h[u](ab,(F=h.firstChild));M&&h[u](M,F);V=S>0&&setTimeout(function(){T(B)},S)}return K}E.setup=function(F){f.extend(l,F)};f.jsonp=E})(jQuery);


(function(d,f,g,a){var e="bayerSharePrice",b={lang:"en",interval:300000,more_link:{en:"http://www.investor.bayer.com/en/aktie/kursinformationen/",de:"http://www.investor.bayer.de/de/aktie/kursinformationen/"},service_url:"http://www.bayer.com/module/json/share-price/rest/cb_callback.aspx"};function h(k,j){this.element=k;this.options=d.extend({},b,j);this._defaults=b;this._name=e;this.init()}function c(j,k){if(k!=="de"){return j}j.price=j.price.replace(",",".");j.price=i(j.price,".",",");j.percent_change=j.percent_change.replace(".",",");return j}function i(j,l,k){lastIndex=j.lastIndexOf(l);firstpart=j.substring(0,lastIndex);secondpart=j.substring(lastIndex).replace(l,k);return firstpart+secondpart}h.prototype={init:function(){var j=this;$self=d(this.element);setInterval(function(){j.get_ticker_data()},this.options.interval);this.get_ticker_data()},get_ticker_data:function(k,j){var l=this;d.jsonp({callback:"callback",cache:true,url:l.options.service_url,success:function(m){l.process_ticker_data(m)}})},process_ticker_data:function(m){var k=m.length,p="";if(k<1){return false}for(var l=0;l<k;l++){var o={de:m[l].date_format_de,en:m[l].date_format_en},n=(parseFloat(m[l].percent_change)<0)?"down":"up";if(parseFloat(m[l].percent_change)==0){n="eq"}m[l]=c(m[l],this.options.lang);p+='<div class="tickerelement"><a href="'+this.options.more_link[this.options.lang]+'">'+m[l].name+": "+m[l].price+'&nbsp;<span class="'+n+' ir">'+n+"</span>&nbsp;"+m[l].percent_change+'&nbsp;%</a><br><span class="small">'+o[this.options.lang]+"</span></div>"}$self.append().html(p)}};d.fn[e]=function(j){return this.each(function(){if(!d.data(this,"plugin_"+e)){d.data(this,"plugin_"+e,new h(this,j))}})}})(jQuery,window,document);